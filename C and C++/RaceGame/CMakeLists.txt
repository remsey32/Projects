PROJECT(MyProject)
CMAKE_MINIMUM_REQUIRED(VERSION 2.8)

# specify sources and headers
SET(HDRS graphics.h gridfont.h race.h) # module headers go here (*.h)
SET(SRCS main.cpp graphics.cpp gridfont.cpp race.cpp) # module implementations go here (*.cpp)

# C++ standard
SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -std=c++98 -Wall")

# extend cmake module path
set(CMAKE_MODULE_PATH ${PROJECT_SOURCE_DIR}/CMakeModules)

# find NCurses
FIND_PACKAGE(Curses REQUIRED)
INCLUDE_DIRECTORIES(${CURSES_INCLUDE_DIRS})

# find SDL
FIND_PACKAGE(SDL QUIET)
IF (SDL_FOUND)
   INCLUDE_DIRECTORIES(${SDL_INCLUDE_DIR})
   INCLUDE_DIRECTORIES(${SDL_INCLUDE_DIR/SDL})
ENDIF (SDL_FOUND)

# find SDL mixer
FIND_PACKAGE(SDL_mixer QUIET)
IF (SDL_MIXER_FOUND)
   INCLUDE_DIRECTORIES(${SDL_MIXER_INCLUDE_DIR})
ENDIF (SDL_MIXER_FOUND)

# find SDL2
FIND_PACKAGE(SDL2 QUIET)
IF (SDL2_FOUND)
   INCLUDE_DIRECTORIES(${SDL2_INCLUDE_DIR})
   INCLUDE_DIRECTORIES(${SDL2_INCLUDE_DIR/SDL2})
ENDIF (SDL2_FOUND)

# find SDL2 mixer
FIND_PACKAGE(SDL2_mixer QUIET)
IF (SDL2_MIXER_FOUND)
   INCLUDE_DIRECTORIES(${SDL2_MIXER_INCLUDE_DIR})
ENDIF (SDL2_MIXER_FOUND)

# SDL check
IF ((SDL_FOUND AND SDL_MIXER_FOUND) OR (SDL2_FOUND AND SDL2_MIXER_FOUND))
   ADD_DEFINITIONS("-DHAVE_SDL")
   MESSAGE(STATUS "SDL found")
ENDIF ((SDL_FOUND AND SDL_MIXER_FOUND) OR (SDL2_FOUND AND SDL2_MIXER_FOUND))

# build and link executable
ADD_EXECUTABLE(main ${HDRS} ${SRCS}) # compile main executable
TARGET_LINK_LIBRARIES(main
   ${CURSES_LIBRARIES} # link with NCurses
   )
IF (SDL_FOUND AND SDL_MIXER_FOUND)
   TARGET_LINK_LIBRARIES(main
      ${SDL_LIBRARY} # link with SDL
      ${SDL_MIXER_LIBRARY} # link with SDL mixer
      )
ENDIF (SDL_FOUND AND SDL_MIXER_FOUND)
IF ((SDL2_FOUND AND SDL2_MIXER_FOUND) AND NOT (SDL_FOUND OR SDL_MIXER_FOUND))
   TARGET_LINK_LIBRARIES(main
      ${SDL2_LIBRARY} # link with SDL2
      ${SDL2_MIXER_LIBRARY} # link with SDL2 mixer
      )
ENDIF ((SDL2_FOUND AND SDL2_MIXER_FOUND) AND NOT (SDL_FOUND OR SDL_MIXER_FOUND))
